<!doctype html><html lang=en><head><title>Finding a rank 1 matrix orthogonal to another matrix | Gabriel H. Brown</title><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin=anonymous><link rel=stylesheet href=https://ghbrown.net/css/palettes/color-splotch.css><link rel=stylesheet href=https://ghbrown.net/css/risotto.css><link rel=stylesheet href=https://ghbrown.net/css/custom.css><script src=https://ghbrown.net/assets/quotes.js></script><script src=https://ghbrown.net/js/serve_quote.js></script><script type=text/javascript src=//code.jquery.com/jquery-latest.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><ul><h1 class=page__logo><a href=https://ghbrown.net/ class=page__logo-inner>Gabriel H. Brown</a></h1><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/ title>About Me</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/research title>Research</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/publications title>Publications</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/open_source title>Open Source</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/hobbies_and_interests title>Hobbies</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/tags title>Post Topics</a></li></ul></nav></header><section class=page__body><div class=content__body><h1 id=finding-a-rank-1-matrix-orthogonal-to-another-matrix>Finding a rank 1 matrix orthogonal to another matrix</h1><hr><p>Recently I needed to solve the following problem: given a square matrix $\mathbf{A}$ find another square matrix $\mathbf{B}$ satisfying
$\text{vec}(\mathbf{A})^T \text{vec}(\mathbf{B}) = 0$.
This is the sense in which I use the word orthogonal here, rather than the columns of $\mathbf{A}$ or $\mathbf{B}$ being orthogonal.
Anyway, it&rsquo;s impossible for the columns of a rank 1 matrix to be orthogonal.</p><p>If you are like me this problem sounds: easy at first glance, then quite difficult, then easy again.
Here is my solution.</p><p>Since we seek a rank 1 matrix, let $\mathbf{B} = \mathbf{x} \mathbf{y}^T$.
Now note that</p><p>$$
\text{vec}(\mathbf{A})^T \text{vec}(\mathbf{B}) =
\sum_{ij} \mathbf{A}_{ij} \mathbf{B}_{ij} =
\sum_{ij} \mathbf{A}_{ij} \mathbf{x}_{i} \mathbf{y}_j =
\mathbf{x}^T \mathbf{Ay} .
$$</p><p>So, if we can choose $\mathbf{x}, \mathbf{y}$ such that
$\mathbf{x}^T \mathbf{Ay}$ we have solved the problem.
This can be done by choosing $\mathbf{y}$ and $\mathbf{x}_{1:n-1}$ randomly and computing the last element $\mathbf{x}_n$ as the solution to a scalar equation, as follows</p><p>$$
\mathbf{p} \coloneqq \mathbf{Ay} \\
\mathbf{x}_n = \frac{-\mathbf{x}_{1:n-1}^T \mathbf{p}_{1:n-1}}{\mathbf{p}_{n}} .
$$</p><p>A short Python snippet implementing this algorithm is given below, it also normalizes the matrix $\mathbf{B}$.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>numpy</span> <span class=kn>import</span> <span class=n>outer</span><span class=p>,</span> <span class=n>inner</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>numpy.linalg</span> <span class=kn>import</span> <span class=n>norm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>numpy.random</span> <span class=kn>import</span> <span class=n>normal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>orthogonal_rank_1_matrix</span><span class=p>(</span><span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># input: A, any square matrix</span>
</span></span><span class=line><span class=cl>    <span class=c1># output: a rank 1 matrix B satisfying vec(A)^Tvec(B) = 0</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>n</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>normal</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>n</span><span class=p>,))</span>  <span class=c1># only using x[:-1]</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>A</span><span class=nd>@y</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>inner</span><span class=p>(</span><span class=n>p</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=n>x</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span><span class=o>/</span><span class=n>p</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>B</span> <span class=o>=</span> <span class=n>outer</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>norm</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>*</span><span class=n>norm</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>B</span>
</span></span></code></pre></div><hr><h3 id=comments>Comments</h3><ul><li>The case where one seeks a rank $k$ matrix is nearly identical.
Initialize the $2nk-1$ elements of the rank $k$ factorization
$\mathbf{B} = \mathbf{X} \mathbf{Y}^T$
randomly, then solve for the remaining element via a scalar equation.</li></ul></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div id=quote><h1>A fun quote</h1></div><script>newQuote()</script></div><hr><div class=aside__content><p>posted 2024-04-06</p></div></section><footer class=page__footer><p class=copyright>Copyright <a href=/>Gabriel H. Brown</a>.</p></footer></div></body></html>