<!doctype html><html lang=en><head><title>Orthogonal projection onto an affine subspace | Gabriel H. Brown</title><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin=anonymous><link rel=stylesheet href=https://ghbrown.net/css/palettes/color-splotch.css><link rel=stylesheet href=https://ghbrown.net/css/risotto.css><link rel=stylesheet href=https://ghbrown.net/css/custom.css><script src=https://ghbrown.net/assets/quotes.js></script><script src=https://ghbrown.net/js/serve_quote.js></script><script type=text/javascript src=//code.jquery.com/jquery-latest.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><ul><h1 class=page__logo><a href=https://ghbrown.net/ class=page__logo-inner>Gabriel H. Brown</a></h1><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/ title>About Me</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/research title>Research</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/publications title>Publications</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/open_source title>Open Source</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/topics/hobbies_and_interests title>Hobbies</a></li><li class=main-nav__item><a class=nav-main-item href=https://ghbrown.net/tags title>Post Topics</a></li></ul></nav></header><section class=page__body><div class=content__body><h1 id=orthogonal-projection-onto-an-affine-subspace>Orthogonal projection onto an affine subspace</h1><hr><p>Projection onto a vector subspace is a common task in linear algebra courses.
Affine subspaces, sets of the form
$
\{ \mathbf{v} \in \mathbb{R}^m : \exists \mathbf{c} :
\mathbf{v} = \mathbf{Ac} + \mathbf{b} \}
$
for fixed matrix $\mathbf{A}$ and vector $\mathbf{b}$,
also have well-defined projections.
However, it&rsquo;s difficult to find a direct proof for the projection of a point onto an affine space:
<a href=https://joeyonng.github.io/joeyonng-notebook/Linear%20Algebra/11_Orthogonal_and_Affine_Projection.html target=_blank>example wordy proof 1</a>,
<a href=https://math.stackexchange.com/questions/3989922/orthogonal-projection-onto-affine-subspaces-formula target=_blank>example wordy proof 2</a>.</p><p>Often I find proofs based mostly on words less than desirable, so let&rsquo;s steamroll this result with calculus and linear algebra.</p><p><strong>Lemma</strong>: let
$
F = \{ \mathbf{v} \in \mathbb{R}^m : \exists \mathbf{c} \in \mathbf{R}^n :
\mathbf{v} = \mathbf{Ac} + \mathbf{b} \}
$
be an affine subspace with $\mathbf{A} \in \mathbb{R}^{m \times n}$ and $\mathbf{b} \in \mathbb{R}^m$ fixed, with $m \geq n$ and $\mathbf{A}$ full rank.
Then for $\mathbf{w} \in \mathbb{R}^m$ the projection of $\mathbf{w}$ onto $F$ is given by<p>$$
\mathbf{P}_F(\mathbf{w})
= \mathbf{P}_{\mathbf{A}}(\mathbf{w} - \mathbf{b}) + \mathbf{b}
$$</p>where $\mathbf{P}_F$ is the orthogonal projector onto affine subspace $F$ and
$
\mathbf{P}_{\mathbf{A}}
$
is the orthogonal projector onto linear subspace $\text{col}(\mathbf{A})$;
in terms of the pseudoinverse
$
\mathbf{P}_{\mathbf{A}} = \mathbf{A}\mathbf{A}^\dagger.
$</p><p><strong>Proof</strong>:
By definition, the projection of $\mathbf{w}$ is<p>$$
\argmin_{\mathbf{v} \in F} ||\mathbf{w} - \mathbf{v}||_2 .
$$</p>Using the definition/parameterization of $A$ above we can equivalently solve
$$
\min_{\mathbf{c} \in \mathbf{R}^n}
||\mathbf{w} - (\mathbf{Ac} + \mathbf{b})||^2_2
$$
for
$\mathbf{c}^*$,
then write
$\mathbf{v}^* = \mathbf{Ac}^* + \mathbf{b}$
(since $\mathbf{A}$ is full rank, there is a unique correspondence between $\mathbf{v}$ and $\mathbf{c}$).
Note that we&rsquo;ve squared the objective function, but this has no impact on the argmin.
Expanding the objective function of this second problem, we find<p>$$
\mathbf{w}^T \mathbf{w}
- 2\mathbf{c}^T \mathbf{A}^T \mathbf{w}
- 2 \mathbf{w}^T\mathbf{b}
+ \mathbf{c}^T \mathbf{A}^T \mathbf{A} \mathbf{c}
+ 2\mathbf{c}^T \mathbf{A}^T \mathbf{b}
+ \mathbf{b}^T \mathbf{b} \; .
$$</p>Enforcing the first order necessary condition for optimality (gradient with respect to $\mathbf{c}$ is $\mathbf{0}$) and simplifying, we find<p>$$
\mathbf{A}^T \mathbf{A} \mathbf{c}
=
\mathbf{A}^T (\mathbf{w} - \mathbf{b}) .
$$</p>Since $\mathbf{A}^T \mathbf{A}$ is invertible the optimal value of $\mathbf{c}$ is
$(\mathbf{A}^T \mathbf{A})^{-1} \mathbf{A}^T (\mathbf{w} - \mathbf{b})$.
Recalling the definition of pseudoinverse for a column vector-like matrix, the optimal value of $\mathbf{c}$ may be written
$\mathbf{A}^\dagger(\mathbf{w} - \mathbf{b})$.</p><p>This is the optimal solution to the second problem (over $\mathbf{c}$), but recall that we want the solution of the first problem (over $\mathbf{v}$).
Using the aforementioned relationship between the argmins of the two problems
($\mathbf{v}^* = \mathbf{Ac}^* + \mathbf{b}$)
we find that the nearest point to $\mathbf{w}$ in the affine subspace $F$
(that is, $\mathbf{P}_F(\mathbf{w})$) is<p>$$
\mathbf{AA}^\dagger(\mathbf{w} - \mathbf{b}) + \mathbf{b}
$$</p>as stated.</p></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div id=quote><h1>A fun quote</h1></div><script>newQuote()</script></div><hr><div class=aside__content><p>posted 2024-07-29</p></div></section><footer class=page__footer><p class=copyright>Copyright <a href=/>Gabriel H. Brown</a>.</p></footer></div></body></html>